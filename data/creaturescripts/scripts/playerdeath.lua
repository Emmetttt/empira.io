local vocationEquipment = 
{
	[5] = { -- sorcerer
		[1]	= { Id = 2195, Slot = CONST_SLOT_FEET, Text = "Kill 1: BOH" }, -- BOH
		[2]	= { Id = 2206, Slot = CONST_SLOT_RING, Text = "Kill 2: 1hr Time Ring" }, -- Time Ring
		[3]	= { Id = 24848, Slot = CONST_SLOT_HEAD, Text = "Kill 3: +5ML Helmet" }, -- shamanic mask
		[4]	= { Id = 7894, Slot = CONST_SLOT_LEGS, Text = "Kill 4: +5ML Legs" }, -- Magma legs
		[5]	= { Id = 18390, Slot = CONST_SLOT_LEFT, Text = "Kill 5: New Wand! +10ML" }, -- Wand of Defiance
		[6]	= { Id = 7899, Slot = CONST_SLOT_ARMOR, Text = "Kill 6: +5ML Armor" }, -- Magma coat
		[7]	= { Id = 8905, Slot = CONST_SLOT_RIGHT, Text = "Kill 7: +Regeneration Shield" }, -- rainbow shield
		[9]	= { Id = 5741, Slot = CONST_SLOT_HEAD, Text = "Kill 9: +8ML Helmet" }, -- Skull helmet
		[11]	= { Id = 8890, Slot = CONST_SLOT_ARMOR, Text = "Kill 11: +8ML Armor" }, -- Robe of the underworld
		[13]= { Id = 13760, Slot = CONST_SLOT_LEFT, Text = "Kill 13: New Wand! +20ML" }, -- Wand of Dimensions
		[15]= { Id = 2504, Slot = CONST_SLOT_LEGS, Text = "Kill 15: +8ML Legs" }, -- Dwarven Legs
		[17]= { Id = 2640, Slot = CONST_SLOT_FEET, Text = "Kill 17: +Regeneration +Speed Boots" }, -- soft boots
	},
	[6] = { -- druid
		[1]	= { Id = 18528, Slot = CONST_SLOT_RING, Text = "Kill 1: +100 Speed Ring" }, -- prismatic ring
		[2]	= { Id = 8910, Slot = CONST_SLOT_LEFT, Text = "Kill 2: New Rod!"}, -- Underworld Rod
		[3]	= { Id = 7902, Slot = CONST_SLOT_HEAD, Text = "Kill 3: +5% Death/Physical Resistance Helmet" }, -- glacial mask
		[4]	= { Id = 7896, Slot = CONST_SLOT_LEGS, Text = "Kill 4: +5% Death/Physical Resistance Legs" }, -- glacial kilt
		[5]	= { Id = 25888, Slot = CONST_SLOT_LEFT, Text = "Kill 5: New Rod!" }, -- Rod of Mayhem
		[6]	= { Id = 7897, Slot = CONST_SLOT_ARMOR, Text = "Kill 6: +5% Death/Physical Resistance Armor" }, -- glacial robe
		[7]= { Id = 7892, Slot = CONST_SLOT_FEET, Text = "Kill 7: +5% Death/Physical Resistance Shoes" }, -- glacial shoes
		[8]= { Id = 8918, Slot = CONST_SLOT_RIGHT, Text = "Kill 8: +Regeneration +Speed Spellbook" }, -- spellbook of dark mysteries
		
		[9]	= { Id = 7901, Slot = CONST_SLOT_HEAD, Text = "Kill 9: +10% Death/Physical Resistance Helmet" }, -- lighning headband
		[11]= { Id = 7895, Slot = CONST_SLOT_LEGS, Text = "Kill 11: +10% Death/Physical Resistance Legs" }, -- lightning legs
		[13]= { Id = 7898, Slot = CONST_SLOT_ARMOR, Text = "Kill 13: +10% Death/Physical Resistance Legs" }, -- lightning robe
		[15]= { Id = 7893, Slot = CONST_SLOT_FEET, Text = "Kill 15: +10% Death/Physical Resistance Shoes" }, -- lightning shoes
	},
	[7] = { -- paladin
		[1]	= { Id = 2195, Slot = CONST_SLOT_FEET, Text = "Kill 1: Boh" }, -- BOH
		[2]	= { Id = 21690, Slot = CONST_SLOT_LEFT, Text = "Kill 2: New Crossbow!"}, -- triple bolt crossbow
		[3]	= { Id = 12645, Slot = CONST_SLOT_HEAD, Text = "Kill 3: +5 Distance Helmet" }, -- Draken helmet
		[4]	= { Id = 9777, Slot = CONST_SLOT_LEGS, Text = "Kill 4: +5 Distance Legs" }, -- Yala legs
		[5]	= { Id = 9776, Slot = CONST_SLOT_ARMOR, Text = "Kill 5: +5 Death Resistance Armor " }, -- Yala Armor

		[6]	= { Id = 8850, Slot = CONST_SLOT_LEFT, Text = "Kill 6: New Crossbow!" }, -- Chain bolter
		[7]	= { Id = 2206, Slot = CONST_SLOT_RING, Text = "Kill 7: 1hr Time Ring" }, -- Time Ring
		[8]	= { Id = 18406, Slot = CONST_SLOT_FEET, Text = "Kill 8: Speed 30 +5arm Boots" }, -- primatic boots
		[9]	= { Id = 18403, Slot = CONST_SLOT_HEAD, Text = "Kill 9: +10 Distance Helmet" }, -- primatic helmet
		[11]= { Id = 18405, Slot = CONST_SLOT_LEGS, Text = "Kill 11: +10 Distance Legs" }, -- primatic legs
		[13]= { Id = 18404, Slot = CONST_SLOT_ARMOR, Text = "Kill 13: +10% Death Resistance Armor" }, -- primatic Armor
		
		[15]= { Id = 18453, Slot = CONST_SLOT_LEFT, Text = "Kill 15: New Crossbow!"}, -- Crystal Crossbow
	},
	[8] = { -- knight
		[1]	= { Id = 2195, Slot = CONST_SLOT_FEET, Text = "Kill 1: BOH" }, -- BOH
		[2]	= { Id = 2472, Slot = CONST_SLOT_ARMOR, Text = "Kill 2: +5 skill MPA (Arm: 20)" }, -- MPA
		[3]	= { Id = 2197, Slot = CONST_SLOT_IN_BACKPACK, Text = "Kill 3: x30 Charge SSA"}, -- SSA
		[4]	= { Id = 2496, Slot = CONST_SLOT_HEAD, Text = "Kill 4: +5 skill Helmet (Arm: 12)"}, -- Horned Helmet
		[5]	= { Id = 8926, Slot = CONST_SLOT_LEFT, Text = "Kill 5: New Weapon!"}, -- Demonwing Axe
		[6]	= { Id = 15412, Slot = CONST_SLOT_LEGS, Text = "Kill 6: +5 skill Legs (Arm: 11)"}, -- Ornate Legs
		[7]	= { Id = 2206, Slot = CONST_SLOT_RING, Text = "Kill 7: 1hr Time Ring"},	 -- Time ring

		[8]	= { Id = 21708, Slot = CONST_SLOT_FEET, Text = "Kill 8: +60 speed Boots (Arm: 4)"}, -- vampire slippers
		[9]	= { Id = 8889, Slot = CONST_SLOT_ARMOR, Text = "Kill 9: +5 skill +20% Death Resistance -50% Holy Resistance (Arm: 22)"}, -- Skullcracker armor
		[11]= { Id = 7453, Slot = CONST_SLOT_LEFT, Text = "Kill 11: New Weapon!"}, -- executioner
		[13]= { Id = 24809, Slot = CONST_SLOT_HEAD, Text = "Kill 13: +10 skill Helmet (Arm: 13)"}, -- dark wizard's crown
		[15]= { Id = 15409, Slot = CONST_SLOT_LEGS, Text = "Kill 15: +10 skill +5% Physical Resistance Legs (Arm: 12)"}, -- depth orcrae
	},
}
local baseExpGain = 5000000

function onDeath(player, corpse, killer, mostDamageKiller, lastHitUnjustified, mostDamageUnjustified)
	incrementSet(killer)
	addExp(killer, player)
	addKill(killer, player)

	if ( (killer:isPlayer() and mostDamageKiller:isPlayer() and killer:getGuid() ~= mostDamageKiller:getGuid()) or (mostDamageKiller:isPlayer() and not killer:isPlayer())) then
		incrementSet(mostDamageKiller)
		addExp(mostDamageKiller, player)
		addKill(mostDamageKiller, player)
	end

	if (player:isPlayer()) then
		player:addDeath()
		player:sendTextMessage(MESSAGE_EVENT_ADVANCE, "You are dead.")
		equipStarterEquipment(player)
	end
end

function addExp(killer, creature)
	if (killer == nil or creature == nil or not killer:isPlayer()) then
		return true
	end
	killer:addExperience(baseExpGain * creature:getStreak() * math.random(0.5, 1.5))

	return true
end

function addKill(killer, creature)
	if (killer == nil or creature == nil or not killer:isPlayer()) then
		return true
	end
	killer:addKill()

	if (creature:isPlayer()) then
		killer:addPlayerKill()
	else
		killer:addBotKill()
	end
end

function incrementSet(player)
	if (player == nil or not player:isPlayer()) then
		return true
	end
	
	local vocation = player:getVocation():getId()
	local config = vocationEquipment[vocation][player:getStreak()]

	if (config == nil) then
		return true
	end

	if (config.Slot == CONST_SLOT_IN_BACKPACK) then
		local backpack = player:getSlotItem(CONST_SLOT_BACKPACK)
		if (backpack == nil) then
			return true
		end

		backpack:addItem(config.Id, 30)
		player:sendTextMessage(MESSAGE_EVENT_ADVANCE, config.Text)
		return true
	end

	local item = player:getSlotItem(config.Slot)
	if item then
		item:remove(1)
	end
	player:addItemEx(Game.createItem(config.Id, 1), false, config.Slot)
	player:sendTextMessage(MESSAGE_EVENT_ADVANCE, config.Text)
end
